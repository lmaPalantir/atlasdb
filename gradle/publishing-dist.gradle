apply plugin: 'maven-publish'

publishing {
    repositories {
        maven {
            url System.env.ARTIFACTORY_URL + (project.version ==~ releaseVersionRegex ? System.env.ARTIFACTORY_DIST_RELEASE_REPO : System.env.ARTIFACTORY_DIST_SNAPSHOT_REPO)

            credentials {
                username System.env.ARTIFACTORY_USERNAME
                password System.env.ARTIFACTORY_PASSWORD
            }
        }
    }
}

ext {
    releaseVersionRegex = /\d+\.\d+\.\d+(-alpha|-beta)?(\+\d{3})?/
    circleBuildNum = System.getenv('CIRCLE_BUILD_NUM')
}
