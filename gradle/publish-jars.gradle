apply plugin: 'nebula.maven-publish'
apply plugin: 'nebula.source-jar'
apply from: "$rootDir/gradle/artifactory-urls.gradle"

publishing {
    repositories {
        maven {
            url artifactoryJarUrl()

            credentials {
                username System.env.ARTIFACTORY_USERNAME
                password System.env.ARTIFACTORY_PASSWORD
            }
        }
    }
}

publish.onlyIf {
    System.getenv('ARTIFACTORY_USERNAME') && System.getenv('ARTIFACTORY_PASSWORD') && System.getenv('ARTIFACTORY_JAR_REPO') && System.getenv('ARTIFACTORY_URL') && !(project.version ==~ releaseVersionRegex)
}
